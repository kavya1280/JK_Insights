{"version":3,"file":"Serializer.js","sourceRoot":"","sources":["../../../../../src/.internal/plugins/json/Serializer.ts"],"names":[],"mappings":"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","sourcesContent":["import { Entity, IEntityEvents, IEntitySettings, IEntityPrivate } from \"../../core/util/Entity\";\nimport { Component } from \"../../core/render/Component\";\nimport { Color } from \"../../core/util/Color\";\nimport { Gradient } from \"../../core/render/gradients/Gradient\";\nimport { Percent } from \"../../core/util/Percent\";\nimport { Template } from \"../../core/util/Template\";\nimport { ListData } from \"../../core/util/Data\";\n\nimport * as $type from \"../../core/util/Type\";\nimport * as $array from \"../../core/util/Array\";\nimport * as $object from \"../../core/util/Object\";\n\n\nexport interface ISerializerSettings extends IEntitySettings {\n\n\t/**\n\t * An array of settings to not include in the serialized data.\n\t */\n\texcludeSettings?: Array<string>;\n\n\t/**\n\t * An array of settings to include in the serialized data.\n\t */\n\tincludeSettings?: Array<string>;\n\n\t/**\n\t * Include full values of these settings.\n\t *\n\t * @since 6.4.3\n\t */\n\tfullSettings?: Array<string>;\n\n\t/**\n\t * An array of properties to not include in the serialized data.\n\t *\n\t * @since 5.3.2\n\t */\n\texcludeProperties?: Array<string>;\n\n\t/**\n\t * An array of properties to include in the serialized data.\n\t *\n\t * @ignore\n\t * @since 5.15.0\n\t */\n\tincludeProperties?: Array<string>;\n\n\t/**\n\t * Maximum depth of recursion when traversing target object.\n\t *\n\t * @default 2\n\t */\n\tmaxDepth?: number;\n\n\t/**\n\t * Include states in the output.\n\t *\n\t * @default false\n\t * @since 5.15.0\n\t */\n\tincludeStates?: boolean;\n\n\t/**\n\t * Include adapters in the output.\n\t *\n\t * @default false\n\t * @since 5.15.0\n\t */\n\tincludeAdapters?: boolean;\n\n\t/**\n\t * Include events in the output.\n\t *\n\t * @since 5.15.0\n\t * @default false\n\t * @todo implement\n\t * @ignore\n\t */\n\tincludeEvents?: boolean;\n\n\t/**\n\t * Serialize functions as strings or functions.\n\t *\n\t * @default \"function\"\n\t */\n\tfunctionsAs?: \"string\" | \"function\";\n\n}\n\nexport interface ISerializerPrivate extends IEntityPrivate {\n}\n\nexport interface ISerializerEvents extends IEntityEvents {\n}\n\n\n/**\n * Provides functionality to serialize charts or individual elements into simple\n * objects or JSON.\n *\n * @see {@link https://www.amcharts.com/docs/v5/concepts/serializing/} for more info\n * @since 5.3.0\n */\nexport class Serializer extends Entity {\n\n\tpublic static className: string = \"Serializer\";\n\tpublic static classNames: Array<string> = Entity.classNames.concat([Serializer.className]);\n\n\tdeclare public _settings: ISerializerSettings;\n\tdeclare public _privateSettings: ISerializerPrivate;\n\tdeclare public _events: ISerializerEvents;\n\n\tprotected _refs: { [index: string]: any } = {};\n\n\t/**\n\t * Serializes target object into a simple object or JSON string.\n\t *\n\t * @param   source      Target object\n\t * @param   depth       Current depth\n\t * @param   full        Serialize object in full (ignoring maxDepth)\n\t * @param   forceParse  If true, will add __parse to serialized objects\n\t * @return              Serialized data\n\t */\n\tpublic serialize(source: unknown, depth: number = 0, full: boolean = false, forceParse: boolean = false): unknown {\n\t\tif (depth > this.get(\"maxDepth\", 2)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (source === false || source === true) {\n\t\t\treturn source;\n\t\t}\n\n\t\tif ($type.isArray(source)) {\n\t\t\tconst res: any[] = [];\n\t\t\t$array.each(source, (arrval) => {\n\t\t\t\tres.push(this.serialize(arrval, depth, full, forceParse));\n\t\t\t});\n\t\t\treturn res;\n\t\t}\n\t\telse if (source instanceof ListData) {\n\t\t\tconst res: any[] = [];\n\t\t\t$array.each(source.values, (arrval) => {\n\t\t\t\tres.push(this.serialize(arrval, depth, full, forceParse));\n\t\t\t});\n\t\t\treturn res;\n\t\t}\n\t\tconst res: any = {};\n\n\t\tconst am5object = source instanceof Entity || source instanceof Template || source instanceof Color || source instanceof Percent ? true : false;\n\n\t\t// Process settings\n\t\tconst fullSettings: any = this.get(\"fullSettings\", []);\n\t\tif (source instanceof Entity) {\n\t\t\tres.type = source.className;\n\t\t\tlet settings: Array<string> = this._filterSettings($object.keys(source._settings));\n\n\t\t\t// Include only user settings\n\t\t\tsettings = settings.filter((value) => {\n\t\t\t\treturn source.isUserSetting(value as any);\n\t\t\t});\n\n\t\t\tif (settings.length) {\n\t\t\t\tres.settings = {};\n\t\t\t\t$array.each(settings, (setting) => {\n\t\t\t\t\tconst settingValue = (<any>source).get(setting);\n\t\t\t\t\tif (settingValue !== undefined) {\n\t\t\t\t\t\tres.settings[setting] = this.serialize(settingValue, depth + 1, full || fullSettings.indexOf(setting) !== -1);\n\t\t\t\t\t\tif (source instanceof Gradient && setting === \"stops\") {\n\t\t\t\t\t\t\tres.settings[setting] = this.serialize(settingValue, 0, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis._processAdapters(source, res);\n\t\t\tthis._processStates(source, res);\n\t\t}\n\t\telse if (source instanceof Template) {\n\t\t\tres.type = \"Template\";\n\t\t\tlet settings: Array<string> = this._filterSettings($object.keys(source._settings));\n\t\t\tif (settings.length) {\n\t\t\t\tres.settings = {};\n\t\t\t\t$array.each(settings, (setting) => {\n\t\t\t\t\tif ((<any>source)._settings[setting] !== undefined) {\n\t\t\t\t\t\tres.settings[setting] = this.serialize((<any>source).get(setting), depth + 1, fullSettings.indexOf(setting) !== -1);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis._processAdapters(source, res);\n\t\t\tthis._processStates(source, res);\n\n\t\t\treturn res;\n\t\t}\n\n\t\t// Data\n\t\tif (source instanceof Component) {\n\t\t\tif (source.data.length && (this.get(\"excludeProperties\")! || []).indexOf(\"data\") === -1) {\n\t\t\t\tres.properties = {\n\t\t\t\t\tdata: this.serialize(source.data.values, depth, true)\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\t// Process the rest\n\t\tif (source instanceof Color) {\n\t\t\treturn {\n\t\t\t\ttype: \"Color\",\n\t\t\t\tvalue: source.toCSSHex()\n\t\t\t};\n\t\t}\n\t\telse if (source instanceof Percent) {\n\t\t\treturn {\n\t\t\t\ttype: \"Percent\",\n\t\t\t\tvalue: source.percent\n\t\t\t};\n\t\t}\n\t\telse if ($type.isString(source)) {\n\t\t\treturn this._escapeRefs(source);\n\t\t}\n\t\telse if ($type.isNumber(source)) {\n\t\t\treturn source;\n\t\t}\n\t\telse if ($type.isObject(source)) {\n\t\t\t// TODO\n\t\t\tif (full && !am5object) {\n\t\t\t\tconst excludeProperties: Array<string> = this.get(\"excludeProperties\", []);\n\t\t\t\t$object.each(source, (key, value) => {\n\t\t\t\t\tif (excludeProperties.indexOf(key) === -1 && value !== undefined) {\n\t\t\t\t\t\tres[key] = this.serialize(value, depth + 1, full, forceParse);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (forceParse) {\n\t\t\t\t\t// Add only if there are objects\n\t\t\t\t\t$object.each(res, (_key, value) => {\n\t\t\t\t\t\tif ($type.isObject(value)) {\n\t\t\t\t\t\t\tres.__parse = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (am5object) {\n\t\t\t\tconst includeProperties: Array<string> = this.get(\"includeProperties\", []);\n\t\t\t\t$array.each(includeProperties, (key) => {\n\n\t\t\t\t\tconst value: any = (source as any)[key];\n\t\t\t\t\tif (value !== undefined) {\n\t\t\t\t\t\tif (res.properties === undefined) {\n\t\t\t\t\t\t\tres.properties = {};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tres.properties[key] = this.serialize(value, depth + 1, full, forceParse);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (depth == 0 && $object.keys(this._refs).length) {\n\t\t\tres.refs = this._refs;\n\t\t}\n\n\t\treturn res;\n\t}\n\n\tprivate _processAdapters(source: any, res: any) {\n\t\tif (this.get(\"includeAdapters\", false)) {\n\t\t\tconst asString = this.get(\"functionsAs\", \"string\") == \"string\";\n\t\t\tconst callbacks = source.adapters._callbacks;\n\t\t\tif (Object.keys(callbacks).length > 0) {\n\t\t\t\tres.adapters = [];\n\t\t\t\t$object.each(callbacks, (key, callbackList) => {\n\t\t\t\t\tcallbackList.forEach((callback: any) => {\n\t\t\t\t\t\tres.adapters.push({\n\t\t\t\t\t\t\tkey: key,\n\t\t\t\t\t\t\tcallback: asString ? callback.toString() : callback\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _processStates(source: any, res: any) {\n\t\tif (this.get(\"includeStates\", false)) {\n\t\t\tconst states = source.states._states;\n\t\t\tif (Object.keys(states).length > 0) {\n\t\t\t\tres.states = [];\n\t\t\t\t$object.each(states, (key: any, state: any) => {\n\t\t\t\t\tif (Object.keys(state._settings).length > 0) {\n\t\t\t\t\t\tres.states.push({\n\t\t\t\t\t\t\tkey: key,\n\t\t\t\t\t\t\tsettings: this.serialize(state._settings, 0, true)\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _filterSettings(settings: any) {\n\t\tconst includeSettings: Array<string> = this.get(\"includeSettings\", []);\n\t\tconst excludeSettings: Array<string> = this.get(\"excludeSettings\", []);\n\t\tif (includeSettings.length) {\n\t\t\tsettings = includeSettings;\n\t\t}\n\t\telse if (excludeSettings.length) {\n\t\t\tsettings = settings.filter((value: any) => {\n\t\t\t\treturn excludeSettings.indexOf(value) === -1;\n\t\t\t});\n\t\t}\n\t\treturn settings;\n\t}\n\n\tprivate _escapeRefs(text: string): string {\n\t\treturn text.replace(/^#/, '##').replace(/^@/, '@@');\n\t}\n\n}\n"]}